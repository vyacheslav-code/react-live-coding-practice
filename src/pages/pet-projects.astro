---
import { getCollection } from 'astro:content';
import BaseLayout from '../layouts/BaseLayout.astro';

const allTasks = await getCollection('tasks');
const petProjects = allTasks.filter(task => task.data.category === 'pet-projects');
const sortedProjects = petProjects.sort((a, b) => a.data.title.localeCompare(b.data.title));

const difficultyColors = {
  easy: 'bg-green-600',
  medium: 'bg-yellow-600',
  hard: 'bg-red-600',
};
---

<BaseLayout title="Pet Projects - React Live Coding Practice" description="Larger React projects for deeper learning">
  <!-- Hero Section -->
  <div class="border-b border-gray-800 bg-gradient-to-b from-gray-900 to-black -mx-6 -mt-12">
    <div class="max-w-7xl mx-auto px-6 py-16 text-center">
      <h1 class="text-5xl font-bold text-white mb-4">
        Pet Projects
      </h1>
      <p class="text-xl text-gray-400 mb-4">
        {petProjects.length} larger projects for deeper learning
      </p>
      <p class="text-sm text-gray-500 mb-8">
        Not for live coding interviews - take your time with these
      </p>
      <a
        href="/tasks"
        class="inline-flex items-center px-6 py-3 border border-gray-700 hover:border-gray-600 text-gray-300 hover:text-white font-medium rounded-lg transition-colors duration-200"
      >
        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
        </svg>
        Back to Tasks
      </a>
    </div>
  </div>

  <div class="mt-12">
    <!-- Project Grid -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
      {sortedProjects.map((task) => (
        <a
          href={`/tasks/${task.id}`}
          class="group block bg-gray-900 border border-gray-800 rounded-lg p-6 hover:border-gray-700 hover:shadow-xl hover:shadow-purple-900/10 transition-all duration-200"
        >
          <!-- Difficulty Badge -->
          <div class="mb-4">
            <span class={`inline-block px-2.5 py-1 rounded-md text-xs font-semibold text-white ${difficultyColors[task.data.difficulty]}`}>
              {task.data.difficulty.charAt(0).toUpperCase() + task.data.difficulty.slice(1)}
            </span>
          </div>

          <!-- Title -->
          <h3 class="text-xl font-semibold text-white mb-3 group-hover:text-purple-400 transition-colors">
            {task.data.title}
          </h3>

          <!-- Description Preview -->
          <p class="text-gray-400 text-sm mb-4 line-clamp-2">
            {task.data.description}
          </p>

          <!-- Tags -->
          <div class="flex flex-wrap gap-2 mb-4">
            {task.data.tags.slice(0, 3).map((tag) => (
              <span class="px-2 py-1 bg-gray-800 text-gray-300 rounded text-xs font-medium">
                {tag}
              </span>
            ))}
            {task.data.tags.length > 3 && (
              <span class="px-2 py-1 bg-gray-800 text-gray-400 rounded text-xs">
                +{task.data.tags.length - 3}
              </span>
            )}
          </div>

          <!-- Footer -->
          <div class="flex items-center justify-between pt-4 border-t border-gray-800">
            <div class="flex items-center text-gray-400 text-sm">
              <svg class="w-4 h-4 mr-1.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
              </svg>
              ~{task.data.timeEstimate} min
            </div>
            <div class="text-purple-500 text-sm font-medium group-hover:translate-x-1 transition-transform">
              Start â†’
            </div>
          </div>
        </a>
      ))}
    </div>
  </div>

  <style>
    .line-clamp-2 {
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }
  </style>
</BaseLayout>
